{% extends 'base.html' %}

{% block title %}ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è©³ç´°{% endblock %}

{% block contents %}
<div class="container mt-4">
    <h2 class="mb-4">{{ object.subject }}</h2>

    <div class="card mb-4">
        <div class="card-body">
            <p><strong>é€ä¿¡è€…ï¼š</strong>{{ object.sender }}</p>
            <p><strong>å®›å…ˆï¼š</strong>{{ object.recipient }}</p>
            <p><strong>é€ä¿¡æ—¥æ™‚ï¼š</strong>{{ object.created_at|date:"Y/m/d H:i" }}</p>
            <hr>
            {% if object.is_delete %}
                <p class="text-muted"><i>{{ object.body }}</i></p>
            {% else %}
                <p>{{ object.body|linebreaksbr }}</p>
                {% if object.is_update %}
                    <small class="text-muted">(ç·¨é›†æ¸ˆ)</small>
                {% endif %}
            {% endif %}
        </div>
    </div>
    {% if object.attachments.all %}
        <div class="mb-4">
            <h5>ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«</h5>
            <ul>
                {% for attachment in object.attachments.all %}
                    <li>
                        <a href="{{ attachment.file.url }}" target="blank">
                            {{ attachment.file.name|cut:"message_files/"}}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <div class="mt-3">
        {% comment %}è¿”ä¿¡ã¯å—ä¿¡è€…ãŒè‡ªåˆ†ã®å ´åˆã®ã¿è¡¨ç¤º{% endcomment %}
        {% if object.recipient == request.user %}
            <a href="{% url 'sns:message_reply' object.pk %}" class="btn btn-primary">è¿”ä¿¡</a>
            <a href="{% url 'sns:message_forward' object.pk %}" class="btn btn-secondary">è»¢é€</a>
            <a href="{% url 'sns:message_inbox' %}" class="btn btn-outline-dark">å—ä¿¡ãƒœãƒƒã‚¯ã‚¹</a>
        {% endif %}

        {% comment %}ç·¨é›†ãƒ»å‰Šé™¤ã¯é€ä¿¡è€…ã‹è‡ªåˆ†ã¸ã®é€ä¿¡ãƒ†ã‚¹ãƒˆã®å ´åˆã«è¡¨ç¤º{% endcomment %}
        {% if object.sender == request.user or object.recipient == request.user %}
            <a href="{% url 'sns:message_update' object.pk %}" class="btn btn-warning">ç·¨é›†</a>
            <a href="{% url 'sns:message_delete' object.pk %}" class="btn btn-danger">å‰Šé™¤</a>
        {% endif %}

        {% comment %}è»¢é€ã¯é€ä¿¡è€…ã‚‚å—ä¿¡è€…ã‚‚å¯èƒ½{% endcomment %}
        {% if object.sender == request.user %}
            <a href="{% url 'sns:message_forward' object.pk %}" class="btn btn-secondary">è»¢é€</a>
            <a href="{% url 'sns:message_outbox' %}" class="btn btn-outline-dark">é€ä¿¡ãƒœãƒƒã‚¯ã‚¹</a>
        {% endif %}
    </div>
</div>
{% endblock %}